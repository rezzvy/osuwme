class MationHTML{constructor(){this.rules=[]}#a=null;#b=[];set noRuleFallback(e){if("function"!=typeof e)throw Error("Given callback should be a function.");this.#a=e}set ignoreSelectors(e){if(!Array.isArray(e))throw Error("Given tags should be an array of strings.");for(let t of e){if("string"!=typeof t)throw Error("Each selector should be a string.");this.#b.includes(t)||this.#b.push(t)}}register(e){if(Array.isArray(e)){for(let t of e)this.#c(t);this.rules.push(...e)}else this.#c(e),this.rules.push(e)}convert(e,t=!0){if("string"!=typeof e)throw Error("Input must be a string.");let o=new DOMParser,r=o.parseFromString(e,"text/html");return t?this.#d(r.body):this.#d(r.documentElement)}#d(e){let t="";for(let o of e.childNodes)if(o.nodeType===Node.TEXT_NODE)t+=o.textContent;else if(o.nodeType===Node.ELEMENT_NODE){if(this.#b.some(e=>o.matches(e)))continue;t+=this.#e(o).trim()}return t.trim()}#e(r){let l=this.rules.filter(e=>r.matches(e.selector)),n=this.#d(r),s={};for(let i of r.attributes)s[i.name]=i.value;if(l.length>0){let a=n;for(let c of l)if(c.format){let u=c.format({node:r,content:a,dataset:s});if(void 0!==u)a=u;else throw Error(`The format handler for the selector "${c.selector}" must return content.`)}else a=c.to.replace(/{dataset\.([\w-]+)}/g,(e,t)=>s[t]||"").replace(/{content}/g,a).replace(/{spacing}/g,"");return a}if(this.#a&&"function"==typeof this.#a){let f=this.#a({node:r,content:n,dataset:s});if(void 0!==f)return f;throw Error("The noRuleFallback function must return content")}return console.warn(`No rule found for element: <${r.tagName}>`),n}#c(h){if("object"!=typeof h||!h.selector||!(h.to||h.format))throw Error('Invalid rule: Must have a "selector" and a "format" or "to".')}}